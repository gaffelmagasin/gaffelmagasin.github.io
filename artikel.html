<!DOCTYPE html>
<html>
    <head>
        <link rel="icon" type="image/x-icon" href="/favicon.ico">
        <style>
            @font-face {
    		  font-family: morfeta;
    		  src: url(font/MorfetaGealmord-5158V.otf) format("opentype");
    		}

            
            
            body{
                background-color: #000000FF;
            }
            .artikel_hållare{
                background: #FFFFFFFF;
                margin-top: 15px;
                margin: auto;
                justify-content: center;

                width: clamp(100px,95vw, 1000px);
            }
            .titel{
                  font-family: morfeta;
        		  font-size: clamp(10px,10vw,100px);
        		  line-height: 83%;
        		  color: #000000FF;
                  
                  padding-top: 2%;
                  margin-left: 3%;    
            }
            .ingress{
                  font-family: arial;
                  font-weight: bold;
                  
                  padding-top: 2%;
                  margin-left: 3%; 
                  margin-right: 3%; 
                  color: #000000FF;
            }
            .bröd{
                 font-family: georgia;

                padding-top: 2%;
                margin-left: 3%; 
                 margin-right: 3%;
                padding-bottom: 25px;
                color: #000000FF;
            }
            .blogg_bild{
                width: 100%;
                height: auto;
                
            }
            
        </style>
    </head>
    <body>
        <div class = artikel_hållare>
            <div id = 'om_artikeln'></div>
            <div id = 'innehåll'></div>
        </div>
        
        <script>
        function content_of_tag(str,tag,start){
    		let start_index = str.indexOf("<" + tag + ">",start);
    		let end_index =   str.indexOf("</" + tag + ">",start);
    		
    		if(start_index == -1 || end_index == -1){return -1;}
    		let content = str.substring(start_index + tag.length + 2,end_index);
    		return content;
    	}

        var url =window.location.href;
        console.log(url);

        var index_in_url = url.indexOf('artikel?=') + 9
        var tag = url.substring(index_in_url,url.length)
        
        fetch('artiklar/' + tag + '/info.txt')
    	  .then(function(resp) { 
    		  return resp.text()
    	   })
    	  .then(function(resp){
    		var a_str = resp;
    		console.log(a_str);
                       
            var titel = content_of_tag(a_str,"titel",0);
            var preamble = content_of_tag(a_str,"ingress",0);
            var bild = content_of_tag(a_str,"bild",0);
            var skribent = content_of_tag(a_str,"skribent",0);
            
            var buffer = ``   
            
            if(titel == -1 && preamble == -1){
                buffer = `<div class = titel>404 Det är inte du det är jag</div><div class = ingress>Den här artikeln finns inte, är du ledsen över detta så hör av dig på gaffel.magasin@gmail.com<br></div>`
                document.title = 'o_o';
            }
            else{
                document.title = titel;
              
            
                buffer = `<div>
                            <img src = ${bild} class = blogg_bild></img>
                            <div class = titel>${titel}</div>
                            <div class = ingress>${preamble}</div>
                        </div>
                    </div>`
           
                
            }
            document.getElementById('om_artikeln').innerHTML = buffer;
             
          })

          fetch('artiklar/' + tag + '/brödtext.html')
    	  .then(function(resp) { 
    		  return resp.text()
    	   })
    	  .then(function(resp){
    		var a_str = resp;
    		console.log(a_str);
                       
            
           // document.getElementById('om_artikeln').innerHTML = buffer;
             
          })
          </script>
    </body>
</html>
