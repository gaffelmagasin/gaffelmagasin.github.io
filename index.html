<!DOCTYPE html>
<html lang="en">
 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAFFEL</title>

	<style>
		@font-face {
		  font-family: newsagent;
		  src: url(Newsagent-Regular.ttf) format("truetype");
		}
		@font-face {
		  font-family: morfeta;
		  src: url(MorfetaGealmord-5158V.otf) format("opentype");
		}
		
		body{
			background-color: #044827FF;
		}
		
		.blog_area{
			background: #010101ff;
			margin-left: 5vw;
			width: clamp(50px,90vw,1000px);
		}
		.blog_cont{
			margin-bottom: 10px;
			background: #000000ff;
		}
		.blog_row {
			margin: 1%;
			float: left;
			background: #000000ff;
			width: 40%;
		}
		.blog_img{
			float: right;
			width: 55%;
			background: #505050ff;
		}
		.blog_cont::after{
		    content: "";
		    display: table;
		    clear: both;
		}
		.blog_title {
		  font-family: morfeta;
		  font-size: clamp(10px,4vw,50px);
		  line-height: 83%;
		  color: #FFFFFFFF;
		}
		.blog_preamble{
			font-size: clamp(5px,2vw,20px);
			color: #FFFFFFFF;
		}
	</style>
</head>
 
<body>
    <div id ='blogg_inlägg' class = blog_area></div>
    <!-- <iframe id="game-iframe" src="https://bolibompa-cdn.dojnaz.net/svt/spel/drakens-varld" width="600" height="500" title="drakens-varld"></iframe> -->
	<script>

	function content_of_tag(str,tag,start){
		let start_index = str.indexOf("<" + tag + ">",start);
		let end_index =   str.indexOf("</" + tag + ">",start);
		
		if(start_index == -1 || end_index == -1){return -1;}
		let content = str.substring(start_index + tag.length + 2,end_index);
		return content;
	}

	var buffer = ``
	    
	fetch('data.txt')
	  .then(function(resp) { 
		  return resp.text()
	   })
	  .then(function(resp) {
		var a_str = resp;
		console.log(a_str);

		var i = 0;
		var looks = 0;
		var article_i = 0
		while(i < a_str.length){
			var index = a_str.indexOf("<artikel>",i);
			
			i = index+1;
			if(index == -1){
				i = a_str.length;
			}
			else{
				var start_index = index+9
				var end_index = a_str.indexOf("</artikel>",index);
				
				var content = a_str.substring(start_index,end_index);

				//console.log(content);

				var article_index = content_of_tag(content,"index",0);
				var titel = content_of_tag(content,"titel",0);
				titel = titel.toUpperCase();
				var preamble = content_of_tag(content,"ingress",0);
				//console.log(article_index);
				//console.log(titel);
				//console.log(preamble);

				
				
				buffer += `<div class = blog_cont id = ${"aid" + article_i.toString()}>
					<img src = "https://i.imgur.com/4RzXsjc.png" class = blog_img></img>
     					<div class = blog_row>
     						<div class = blog_title>${titel}</div>
			        		<div class = blog_preamble>${preamble}</div>
      					</div>
			        </div>`

				article_i++
			}
		}
		
	
	    document.getElementById('blogg_inlägg').innerHTML = buffer

	    for(let i = 0; i<article_i; i++){

			var element = document.getElementById("aid" + i.toString()); //grab the element
			element.onclick = function(){
				console.log(i);
			}
		}
	  })
	

    </script>


</body>
 
</html>
